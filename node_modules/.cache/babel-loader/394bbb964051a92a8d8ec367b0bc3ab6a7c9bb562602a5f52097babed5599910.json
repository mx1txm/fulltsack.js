{"ast":null,"code":"import { __assign } from \"tslib\";\nimport { useContext, useState, useRef, useEffect, useReducer } from 'react';\nimport { SubscriptionData } from \"../data/index.js\";\nimport { getApolloContext } from \"../context/index.js\";\nimport { useAfterFastRefresh } from \"./utils/useAfterFastRefresh.js\";\nexport function useSubscription(subscription, options) {\n  var _a = useReducer(function (x) {\n      return x + 1;\n    }, 0),\n    forceUpdate = _a[1];\n  var context = useContext(getApolloContext());\n  var updatedOptions = options ? __assign(__assign({}, options), {\n    subscription: subscription\n  }) : {\n    subscription: subscription\n  };\n  var _b = useState({\n      loading: !updatedOptions.skip,\n      error: void 0,\n      data: void 0\n    }),\n    result = _b[0],\n    setResult = _b[1];\n  var subscriptionDataRef = useRef();\n  function getSubscriptionDataRef() {\n    if (!subscriptionDataRef.current) {\n      subscriptionDataRef.current = new SubscriptionData({\n        options: updatedOptions,\n        context: context,\n        setResult: setResult\n      });\n    }\n    return subscriptionDataRef.current;\n  }\n  var subscriptionData = getSubscriptionDataRef();\n  subscriptionData.setOptions(updatedOptions, true);\n  subscriptionData.context = context;\n  if (__DEV__) {\n    useAfterFastRefresh(forceUpdate);\n  }\n  useEffect(function () {\n    return subscriptionData.afterExecute();\n  });\n  useEffect(function () {\n    return function () {\n      subscriptionData.cleanup();\n      subscriptionDataRef.current = void 0;\n    };\n  }, []);\n  return subscriptionData.execute(result);\n}","map":{"version":3,"names":["useContext","useState","useRef","useEffect","useReducer","SubscriptionData","getApolloContext","useAfterFastRefresh","useSubscription","subscription","options","_a","x","forceUpdate","context","updatedOptions","__assign","_b","loading","skip","error","data","result","setResult","subscriptionDataRef","getSubscriptionDataRef","current","subscriptionData","setOptions","__DEV__","afterExecute","cleanup","execute"],"sources":["/Users/meltem/PycharmProjects/fullstack-js/node_modules/@apollo/src/react/hooks/useSubscription.ts"],"sourcesContent":["import { useContext, useState, useRef, useEffect, useReducer } from 'react';\nimport { DocumentNode } from 'graphql';\nimport { TypedDocumentNode } from '@graphql-typed-document-node/core';\n\nimport { SubscriptionHookOptions } from '../types/types';\nimport { SubscriptionData } from '../data';\nimport { OperationVariables } from '../../core';\nimport { getApolloContext } from '../context';\nimport { useAfterFastRefresh } from './utils/useAfterFastRefresh';\n\nexport function useSubscription<TData = any, TVariables = OperationVariables>(\n  subscription: DocumentNode | TypedDocumentNode<TData, TVariables>,\n  options?: SubscriptionHookOptions<TData, TVariables>\n) {\n  const [, forceUpdate] = useReducer(x => x + 1, 0);\n  const context = useContext(getApolloContext());\n  const updatedOptions = options\n    ? { ...options, subscription }\n    : { subscription };\n  const [result, setResult] = useState({\n    loading: !updatedOptions.skip,\n    error: void 0,\n    data: void 0,\n  });\n\n  const subscriptionDataRef = useRef<SubscriptionData<TData, TVariables>>();\n  function getSubscriptionDataRef() {\n    if (!subscriptionDataRef.current) {\n      subscriptionDataRef.current = new SubscriptionData<TData, TVariables>({\n        options: updatedOptions,\n        context,\n        setResult\n      });\n    }\n    return subscriptionDataRef.current;\n  }\n\n  const subscriptionData = getSubscriptionDataRef();\n  subscriptionData.setOptions(updatedOptions, true);\n  subscriptionData.context = context;\n\n  if (__DEV__) {\n    // ensure we run an update after refreshing so that we can resubscribe\n    useAfterFastRefresh(forceUpdate);\n  }\n\n  useEffect(() => subscriptionData.afterExecute());\n  useEffect(() => {\n    return () => {\n      subscriptionData.cleanup();\n      subscriptionDataRef.current = void 0;\n    };\n  }, []);\n\n  return subscriptionData.execute(result);\n}\n"],"mappings":";AAAA,SAASA,UAAU,EAAEC,QAAQ,EAAEC,MAAM,EAAEC,SAAS,EAAEC,UAAU,QAAQ,OAAO;AAK3E,SAASC,gBAAgB,QAAQ,kBAAU;AAE3C,SAASC,gBAAgB,QAAQ,qBAAa;AAC9C,SAASC,mBAAmB,QAAQ,gCAA8B;AAElE,OAAM,SAAUC,eAAeA,CAC7BC,YAAiE,EACjEC,OAAoD;EAE9C,IAAAC,EAAA,GAAkBP,UAAU,CAAC,UAAAQ,CAAC;MAAI,OAAAA,CAAC,GAAG,CAAC;IAAL,CAAK,EAAE,CAAC,CAAC;IAAxCC,WAAW,GAAAF,EAAA,GAA6B;EACjD,IAAMG,OAAO,GAAGd,UAAU,CAACM,gBAAgB,EAAE,CAAC;EAC9C,IAAMS,cAAc,GAAGL,OAAO,GAC3BM,QAAA,CAAAA,QAAA,KAAMN,OAAO;IAAED,YAAY,EAAAA;EAAA,KAC1B;IAAEA,YAAY,EAAAA;EAAA,CAAE;EACd,IAAAQ,EAAA,GAAsBhB,QAAQ,CAAC;MACnCiB,OAAO,EAAE,CAACH,cAAc,CAACI,IAAI;MAC7BC,KAAK,EAAE,KAAK,CAAC;MACbC,IAAI,EAAE,KAAK;KACZ,CAAC;IAJKC,MAAM,GAAAL,EAAA;IAAEM,SAAS,GAAAN,EAAA,GAItB;EAEF,IAAMO,mBAAmB,GAAGtB,MAAM,EAAuC;EACzE,SAASuB,sBAAsBA,CAAA;IAC7B,IAAI,CAACD,mBAAmB,CAACE,OAAO,EAAE;MAChCF,mBAAmB,CAACE,OAAO,GAAG,IAAIrB,gBAAgB,CAAoB;QACpEK,OAAO,EAAEK,cAAc;QACvBD,OAAO,EAAAA,OAAA;QACPS,SAAS,EAAAA;OACV,CAAC;;IAEJ,OAAOC,mBAAmB,CAACE,OAAO;EACpC;EAEA,IAAMC,gBAAgB,GAAGF,sBAAsB,EAAE;EACjDE,gBAAgB,CAACC,UAAU,CAACb,cAAc,EAAE,IAAI,CAAC;EACjDY,gBAAgB,CAACb,OAAO,GAAGA,OAAO;EAElC,IAAIe,OAAO,EAAE;IAEXtB,mBAAmB,CAACM,WAAW,CAAC;;EAGlCV,SAAS,CAAC;IAAM,OAAAwB,gBAAgB,CAACG,YAAY,EAAE;EAA/B,CAA+B,CAAC;EAChD3B,SAAS,CAAC;IACR,OAAO;MACLwB,gBAAgB,CAACI,OAAO,EAAE;MAC1BP,mBAAmB,CAACE,OAAO,GAAG,KAAK,CAAC;IACtC,CAAC;EACH,CAAC,EAAE,EAAE,CAAC;EAEN,OAAOC,gBAAgB,CAACK,OAAO,CAACV,MAAM,CAAC;AACzC"},"metadata":{},"sourceType":"module","externalDependencies":[]}